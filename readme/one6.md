<h1><b>ë‹¤ì–‘í•œ ì—°ê´€ê´€ê³„ ë§¤í•‘ ğŸ™‰</b></h1>
<hr/><br/>
<a href="https://github.com/EungyuCho/orm_group_study/blob/master/README.md">ëª©ì°¨ë¡œ ëŒì•„ê°€ê¸°</a> ğŸƒ 
<h3>6ì¥ì—ì„œëŠ” ë‹¤ì–‘í•œ ì—°ê´€ê´€ê³„ë¥¼ ë‹¤ë£¬ë‹¤.</h3>
ìš°ì„  ë“¤ì–´ê°€ê¸° ì „ì— ë‚´ìš©ì„ í•œë²ˆ ë” ì •ë¦¬í•˜ê³  ë“¤ì–´ê°€ë„ë¡ í•˜ì.<br>
ì—”í‹°í‹°ì˜ ì—°ê´€ê´€ê³„ë¥¼ ë§¤í•‘í•  ë•ŒëŠ” ë‹¤ìŒ 3ê°€ì§€ë¥¼ ê³ ë ¤í•´ì•¼ í•œë‹¤.
<ul>
    <li>ë‹¤ì¤‘ì„±</li>
    <li>ë‹¨ë°©í–¥, ì–‘ë°©í–¥</li>
    <li>ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸</li>
</ul>
ìš°ì„  ë‘ ì—”í‹°í‹°ê°€ ì¼ëŒ€ì¼ì¸ì§€ ì¼ëŒ€ë‹¤ì¸ì§€ ë‹¤ì¤‘ì„±ì„ ê³ ë ¤í•˜ê³  ë‹¤ìŒìœ¼ë¡œ ë‘ì—”í‹°í‹°ê°€ í•œìª½ë§Œ ì°¸ì¡°í•˜ëŠ” ë‹¨ë°©í–¥ì¸ì§€ ì•„ë‹ˆë©´ ì–‘ë°©í–¥ìœ¼ë¡œ ì°¸ì¡°í•˜ëŠ”ì§€ ê³ ë ¤í•˜ê³  ê·¸ë‹¤ìŒì—” ì–‘ë°©í–¥ ê´€ê³„ì¼ ì‹œ ì™¸ë˜í‚¤ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì—°ê´€ê´€ê²Œì˜ ì£¼ì¸ì„ ì„¤ì •í•´ì•¼í•œë‹¤.<br>
<h4>ë‹¤ì¤‘ì„±</h4>
ë‹¤ì¤‘ì„±ì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë‹¤ì¤‘ì„±ë“¤ì´ ìˆë‹¤
<ul>
    <li>ë‹¤ëŒ€ì¼(<code>@ManyToOne</code>)</li>
    <li>ì¼ëŒ€ë‹¤(<code>@OneToMany</code>)</li>
    <li>ì¼ëŒ€ì¼(<code>@OneToOne</code>)</li>
    <li>ë‹¤ëŒ€ë‹¤(<code>@ManyToMany</code>)</li>
</ul>
ë‹¤ì¤‘ì„±ì´ íŒë‹¨í•˜ê¸° ì–´ë ¤ìš¸ ë•Œì—ëŠ” ë°˜ëŒ€ë°©í–¥ì„ ìƒê°í•´ë³´ë©´ ëœë‹¤.
<h4>ë‹¨ë°©í–¥, ì–‘ë°©í–¥</h4>
í…Œì´ë¸”ì€ í•˜ë‚˜ì˜ ì™¸ë˜ í‚¤ë§Œ ê°€ì§€ê³ ë„ ë‘ í…Œì´ë¸”ì„ JOIN í•  ìˆ˜ ìˆìœ¼ë‹ˆ ì‚¬ì‹¤ ë°©í–¥ì˜ ê°œë…ì´ ì—†ì§€ë§Œ ê°ì²´ëŠ” ì°¸ì¡°ìš© í•„ë“œë¥¼ ê°€ì§€ê³  ì—°ê´€ëœ ê°ì²´ë¥¼ ì¡°íšŒí•˜ë¯€ë¡œ ê°ì²´ê´€ê²Œì—ì„œ í•œìª½ë§Œ ì°¸ì¡°í•˜ëŠ”ê²ƒì„ ë‹¨ë°©í–¥ ê´€ê³„, ì–‘ë°©í–¥ì„ ì°¸ì¡°í•˜ëŠ”ê²ƒì´ ì–‘ë°©í–¥ ê´€ê³„ë¼ í•œë‹¤.
<h4>ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸</h4>
ë°ì´í„°ë² ì´ìŠ¤ëŠ” ì™¸ë˜ í‚¤ í•˜ë‚˜ë¡œ ë‘ í…Œì´ë¸”ì´ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤. í•˜ì§€ë§Œ ê°ì²´ëŠ” ì„œë¡œ ë‹¨ë°©í–¥ 2ê°œë¡œ ê´€ê³„ã…–ë¥¼ ë§ºìœ¼ë¯€ë¡œ í¬ì¸íŠ¸ê°€ 2ê³³ì´ë‹¤.<br>
ê·¸ë˜ì„œ JPAëŠ” ë‘ ê°ì²´ ì—°ê´€ê´€ê³„ ì¤‘ í•˜ë‚˜ë¥¼ ì •í•´ì„œ ë°ì´í„°ë² ì´ìŠ¤ ì™¸ë˜ í‚¤ë¥¼ ê´€ë¦¬í•˜ë„ë¡ í•˜ëŠ”ë° ì´ê²ƒì„ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì´ë¼ í•œë‹¤.<br>
ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì´ ì•„ë‹Œ ë°©í–¥ì€ ì™¸ë˜ í‚¤ë¥¼ ë³€ê²½í•  ìˆ˜ ì—†ê³  ì½ê¸°ë§Œ ê°€ëŠ¥í•˜ë‹¤.<br>
ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì€ <code>mappedBy</code> ì†ì„±ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤. ì£¼ì¸ì´ ì•„ë‹ ì‹œ <code>mappedBy</code> ì†ì„±ì„ ì‚¬ìš©í•´ì„œ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ í•„ë“œ ì´ë¦„ì„ ë°”ë¼ë³´ê²Œ í•œë‹¤.
<hr>
<h3>ë‹¤ëŒ€ì¼</h3>
<hr>
<h4>ë‹¤ëŒ€ì¼ ë‹¨ë°©í–¥[N:1]</h4>
<img src="img/entity_many_to_one01.PNG" width="800px" height="350px">
<pre><code>//íšŒì› ì—”í‹°í‹°
@Entity
public class Member{<br>
    @Id @GeneratedValue
    @Column (name = "MEMBER_ID")
    private Long id;<br>
    private String username;<br>
    @ManyToOne
    @JoinColumn (name = "TEAM_ID")
    private Team team;<br>
    //Getter, Setter ...
    ...
}<br>
//íŒ€ ì—”í‹°í‹°
@Entity
public class Team  {<br>
    @Id @GeneratedValue
    @Column (name = "TEAM_ID")
    private Long id;<br>
    private String name;<br>
    //Getter, Setter ...
    ...
}</code></pre>
íšŒì›ì€ Member.teamìœ¼ë¡œ íŒ€ ì—”í‹°í‹°ë¥¼ ì°¸ì¡°í•  ìˆ˜ ìˆì§€ë§Œ íŒ€ì—ì„œëŠ” íšŒì›ì„ ì°¸ì¡°í•  ìˆ˜ ìˆëŠ” í•„ë“œê°€ ì—†ìœ¼ë¯€ë¡œ ë‹¤ëŒ€ì¼ ë‹¨ë°©í–¥ ì—°ê´€ê´€ê³„ì´ë‹¤.
<code>@JoinColumn(name = "TEAM_ID")</code>ë¥¼ ì‚¬ìš©í•´ì„œ Member.team í•„ë“œë¥¼ í…Œì´ë¸”ì˜ TEAM_ID(FK)ì™€ ë§¤í•‘í–ˆë‹¤.
<h4>ë‹¤ëŒ€ì¼ ì–‘ë°©í–¥[N:1, 1:N]</h4>
ë°‘ì˜ ê·¸ë¦¼ì—ì„œ ì‹¤ì„ ì´ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸(Member.team)ì´ê³ , ì ì„ (Team.members)ëŠ” ì—°ê´€ê´€ê²Œì˜ ì£¼ì¸ì´ ì•„ë‹ˆë‹¤.<br>
<img src="img/entity_constraint_many_to_one02.PNG" width="800px" height="350px">
<pre><code>//íšŒì› ì—”í‹°í‹°
@Entity
public class Member{<br>
    @Id @GeneratedValue
    @Column (name = "MEMBER_ID")
    private Long id;<br>
    private String username;<br>
    @ManyToOne
    @JoinColumn (name = "TEAM_ID")
    private Team team;<br>
    public void setTeam(Team team)  {
        this.team = team;<br>
        //ê¸°ì¡´ íŒ€ê³¼ ê´€ê³„ë¥¼ ì œê±°
        if(!team.getMembers().contains(this)){
            this.getMembers().add(this);
        }
    }
}<br>
//íŒ€ ì—”í‹°í‹°
@Entity
public class Team  {<br>
    @Id @GeneratedValue
    @Column (name = "TEAM_ID")
    private Long id;<br>
    private String name;<br>
    @OneToMany(mappedby = "team")
    private List&#60;Member&#62 members = new ArrayList&#60;Member&#62();<br>
    public void addMember (Member member)   {
        this.members.add(member);
        if(member.getTeam() != this)    {   //ë¬´í•œë£¨í”„ì— ë¹ ì§€ì§€ ì•Šë„ë¡ ì²´í¬
            member.setTeam(this);
        }
    }
    ...
}</code></pre>
<h5>ì–‘ë°©í–¥ì€ ì™¸ë˜ í‚¤ê°€ ìˆëŠ” ìª½ì´ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸</h5>
ì¼ë‹¤ëŒ€ì™€ ë‹¤ëŒ€ì¼ì€ í•­ìƒ ë‹¤(N)ì— ì™¸ë˜ í‚¤ê°€ ìˆë‹¤. ë‹¤ìª½ì¸ Memberí…Œì´ë¸”ì— ì™¸ë˜ í‚¤ë¥¼ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì´ë‹¤.
<h5>ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ëŠ” í•­ìƒ ì„œë¡œë¥¼ ì°¸ì¡°í•´ì•¼ í•œë‹¤</h5>
ì–‘ë°©í–¥ ì—°ê´€ê³„ëŠ” í•­ìƒ ì„œë¡œ ì°¸ì¡°í•´ì•¼ í•œë‹¤. ìœ„ì²˜ëŸ¼ Entityì— í¸ì˜ ë©”ì†Œë“œë¥¼ ë§Œë“¤ì–´ì„œ ê´€ë¦¬í•˜ë©´ëœë‹¤. í¸ì˜ë©”ì†Œë“œë¥¼ í•œ
í¸ì˜ë©”ì†Œë“œëŠ” í•œìª½ì—ë§Œ ì‘ì„±í•˜ê±°ë‚˜ ì–‘ìª½ì— ë‹¤ ì‘ì„±í•  ìˆ˜ ìˆëŠ”ë° ì–‘ìª½ì— ì‘ì„± í•  ì‹œ ë¬´í•œë£¨í”„ì— ë¹ ì§€ë¯€ë¡œ ì£¼ì˜í•´ì•¼í•œë‹¤(ë¬´í•œë£¨í”„ íƒˆì¶œ ë¡œì§ì„ êµ¬í˜„í•  ê²ƒ)
<hr>
<h3>ì¼ëŒ€ë‹¤</h3>
<hr>
ì¼ëŒ€ë‹¤ ê´€ê³„ëŠ” ë‹¤ëŒ€ì¼ ê´€ê³„ì˜ ë°˜ëŒ€ ë°©í–¥ì´ë‹¤. ì¼ëŒ€ ë‹¤ ê´€ê³„ëŠ” ì—”í‹°í‹°ë¥¼ í•˜ë‚˜ ì´ìƒ ì°¸ì¡°í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ Collection, List, Set, Map ì¤‘ì— í•˜ë‚˜ë¥¼ ì‚¬ìš©í•˜ì.
<h4>ì¼ëŒ€ë‹¤ ë‹¨ë°©í–¥[1:N]</h4>
í•˜ë‚˜ì˜ íŒ€ì€ íšŒì›ì„ ì°¸ì¡°í•  ìˆ˜ ìˆëŠ”ë° ì´ëŸ° ê´€ê³„ë¥¼ ì¼ëŒ€ë‹¤ ê´€ê³„ë¼ í•œë‹¤. ê·¸ë¦¬ê³  íŒ€ì€ íšŒì›ë“¤ì„ ì°¸ì¡°í•˜ì§€ë§Œ ë°˜ëŒ€ë¡œ íšŒì›ì€ íŒ€ì„ ì°¸ì¡°í•˜ì§€ ì•Šìœ¼ë©´ ë‘˜ì˜ ê´€ê³„ëŠ” ë‹¨ë°©í–¥ì´ë‹¤.
<img src="img/entity_constraint_one_to_many01.PNG" width="800px" height="350px">
ì¼ëŒ€ ë‹¤ ë‹¨ë°©í–¥ ê´€ê³„ëŠ” íŠ¹ì´í•˜ê²Œ Team.membersë¡œ íšŒì› í…Œì´ë¸”ì˜ TEAM_ID ì™¸ë˜ í‚¤ë¥¼ ê´€ë¦¬í•œë‹¤. ì›ë˜ë¼ë©´ Memberí…Œì´ë¸”ì— ì™¸ë˜í‚¤ë¥¼ ì§€ì •í•˜ëŠ”ê²Œ ë§ê² ì§€ë§Œ, í˜„ì¬ ì™¸ë˜ í‚¤ë¥¼ ë§¤í•‘í•  ìˆ˜ ìˆëŠ” í•„ë“œê°€ ì—†ìœ¼ë¯€ë¡œ ë°˜ëŒ€í¸ì—ì„œ ê´€ë¦¬í•˜ëŠ” ëª¨ìŠµì´ ë‚˜íƒ€ë‚œë‹¤.<br>
ì´ì œ ë§¤í•‘í•œ íŒ€ê³¼ íšŒì› ì—”í‹°í‹°ë¥¼ í™•ì¸í•´ë³´ì.
<pre><code>//íšŒì› ì—”í‹°í‹°
@Entity
public class Member{<br>
    @Id @GeneratedValue
    @Column (name = "MEMBER_ID")
    private Long id;<br>
    private String username;<br>
    //Getter, Setter ...
}<br>
//íŒ€ ì—”í‹°í‹°
@Entity
public class Team  {<br>
    @Id @GeneratedValue
    @Column (name = "TEAM_ID")
    private Long id;<br>
    private String name;<br>
    @OneToMany
    @JoinColumn(name = "TEAM_ID")   //MEMBER í…Œì´ë¸”ì˜ TEAM_ID(FK)
    private List&#60;Member&#62 members = new ArrayList&#60;Member&#62();<br>
    //Getter Setter ...
}</code></pre>
ë‹¨ë°©í–¥ ê´€ê³„ë¥¼ ë§¤í•‘í•  ë•ŒëŠ” @JoinColumnì„ ëª…ì‹œí•´ì•¼í•œë‹¤. ìƒëµ í•  ì‹œ JPAëŠ” ì¡°ì¸ í…Œì´ë¸” ì „ëµì„ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©í•´ì„œ ë§¤í•‘í•œë‹¤.(7ì¥ì—ì„œ ì•Œì•„ë³´ì)
<h5>ì¼ëŒ€ë‹¤ ë‹¨ë°©í–¥ ë§¤í•‘ì˜ ë‹¨ì </h5>
ì¼ëŒ€ë‹¤ ë‹¨ë°©í–¥ ë§¤í•‘ì€ ë§¤í•‘í•œ ê°ì²´ê°€ ê´€ë¦¬í•˜ëŠ” ì™¸ë˜ í‚¤ê°€ ë‹¤ë¥¸ í…Œì´ë¸”ì— ìˆë‹¤ëŠ” ì ì´ ë‹¨ì ì´ë‹¤.<br>
ì½”ë“œë¡œ ì™œ ë¶ˆí¸í•œì§€ ì‚´í´ë³´ì.
<pre><code>public void testSave()  {<br>
  Member member1 = new Member("member1", íšŒì›1");
  Member member2 = new Member("member1", íšŒì›2");<br>
    Team team1 = new Team("team1", "íŒ€1");
    team1.getMembers().add(member1);
    team1.getMembers().add(member2);<br>
    em.persist(member1);    //INSERT-member1
    em.persist(member2);    //INSERT-member2
   member1.setTeam(team1);  //INSERT-team1, UPDATE=member1.fk, UPDATE-member2.fk<br>
   transaction.commit();
}</code></pre>
ì‹¤í–‰ ê²°ê³¼ SQLì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
<pre><code>insert into Member (MEMBER_ID, username) values (null, ?)
insert into Member (MEMBER_ID, username) values (null, ?)
insert into Team (TEAM_ID, username) values (null, ?)
update Member set TEAM_ID=? where MEMBER_ID=?
update Member set TEAM_ID=? where MEMBER_ID=?</code></pre>
Member ì—”í‹°í‹°ëŠ” Team ì—”í‹°í‹°ë¥¼ ëª¨ë¥´ë¯€ë¡œ nullë¡œ INSERT í›„ì— TEAM.membersì˜ ì°¸ì¡° ê°’ì„ í™•ì¸í•´ì„œ íšŒì›í…Œì´ë¸”ì— TEAM_IDë¥¼ ì—…ë°ì´íŠ¸í•œë‹¤.
<h4>ì¼ëŒ€ë‹¤ ë‹¨ë°©í–¥ ë§¤í•‘ë³´ë‹¤ ë‹¤ëŒ€ì¼ ì–‘ë°©í–¥ ë§¤í•‘ì„ ì‚¬ìš©í•˜ì</h4>
ê´€ë¦¬ë„ ì„±ëŠ¥ë„ ë¬¸ì œê°€ìˆëŠ” ì¼ëŒ€ë‹¤ ë‹¨ë°©í–¥ë³´ë‹¤ëŠ” ë‹¤ëŒ€ì¼ ì–‘ë°©í–¥ ë§¤í•‘ìœ¼ë¡œ ê´€ë¦¬í•˜ëŠ”ê²Œ ì¢‹ë‹¤.<br>
ë‹¤ëŒ€ì¼ ì–‘ë°©í–¥ ë§¤í•‘ì€ ê´€ë¦¬í•´ì•¼ í•˜ëŠ” ì™¸ë˜ í‚¤ê°€ ë³¸ì¸ í…Œì´ë¸”ì— ìˆìœ¼ë¯€ë¡œ ë‹¨ë°©í–¥ ë§¤í•‘ê°™ì€ ë¬¸ì œê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤.
ì´ì œ íŒ€ ì—”í‹°í‹°, íšŒì›ì—”í‹°í‹° ì½”ë“œë¡œ ì¼ëŒ€ë‹¤ ì–‘ë°©í–¥ ê´€ê³„ë¥¼ ì•Œì•„ë³´ì.
<img src="img/entity_constraint_one_to_many02.PNG" width="800px" height="350px">
<pre><code>//íšŒì› ì—”í‹°í‹°
@Entity
public class Member{<br>
   @Id @GeneratedValue
   @Column (name = "MEMBER_ID")
   private Long id;<br>
   private String username;<br>
   @ManyToOne
   <b>@JoinColumn(name = "TEAM_ID", insertable = false, updatable = false)</b>
   private Team team;<br>
   //Getter, Setter ...
}<br>
//íŒ€ ì—”í‹°í‹°
@Entity
public class Team  {<br>
   @Id @GeneratedValue
   @Column (name = "TEAM_ID")
   private Long id;<br>
   private String name;<br>
   @OneToMany
   @JoinColumn(name = "TEAM_ID")
   private List&#60;Member&#62 members = new ArrayList&#60;Member&#62();<br>
   //Getter Setter ...
}</code></pre>
ì´ë²ˆì—ëŠ” <code>@JoinColumn(name = "TEAM_ID")</code>ë¥¼ ë‘ ì—”í‹°í‹° ëª¨ë‘ì— ì¶”ê°€í–ˆë‹¤.<br>
ì´ ë°©ë²•ì€ ì–‘ë°©í–¥ì²˜ëŸ¼ ë³´ì´ë„ë¡ í•˜ëŠ” ë°©ë²•ìœ¼ë¡œ ì´ ê²½ìš°ì—ëŠ” ëŒ€ë‹¤ì¼ìª½(Member)ì— <code>insertable = false, updatable = false</code>ë¡œ ì½ê¸°ë§Œ ì‚¬ìš© ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •í•´ì£¼ì.
<hr>
<h3>ì¼ëŒ€ì¼</h3>
<hr>
ì¼ëŒ€ì¼ ê´€ê³„ëŠ” ì–‘ìª½ì´ ì„œë¡œ í•˜ë‚˜ì˜ ê´€ê³„ë§Œ ê°€ì§€ëŠ”ë° ì˜ˆë¥¼ ë“¤ì–´ ì‚¬ë¬¼í•¨ê³¼ í•™ìƒì´ ìˆë‹¤.<br>
ì‚¬ë¬¼í•¨ì€ í•™ìƒ í•œëª…ì´ ì‚¬ìš©í•˜ë¯€ë¡œ(ê³µìœ í•˜ì§€ì•ŠìŒ) ì¼ëŒ€ì¼ ê´€ê³„ì´ë‹¤.<br>
ì¼ëŒ€ì¼ ê´€ê³„ëŠ” ë‹¤ìŒê³¼ ê°™ì€ íŠ¹ì§•ì´ ìˆë‹¤.
<ul>
    <li>ì¼ëŒ€ì¼ ê´€ê³„ëŠ” ê·¸ ë°˜ëŒ€ë„ ì¼ëŒ€ì¼ ê´€ê²Œë‹¤</li>
    <li>í…Œì´ë¸” ê´€ê³„ì—ì„œ ì¼ëŒ€ë‹¤, ë‹¤ëŒ€ì¼ì€ í•­ìƒ ë‹¤(N)ìª½ì´ ì™¸ë˜ í‚¤ë¥¼ ê°€ì§€ì§€ë§Œ ì¼ëŒ€ì¼ì€ ì£¼ í…Œì´ë¸”ì´ë‚˜ ëŒ€ìƒ í…Œì´ë¸” ì–´ëŠê³³ì´ë˜ ìƒê´€ì—†ë‹¤.</li>
</ul>
ê´€ê³„ë¥¼ í•˜ë‚˜ì”© ì‚´í´ë³´ì
<h4>ì£¼ í…Œì´ë¸”ì— ì™¸ë˜ í‚¤</h4>
ì¼ëŒ€ì¼ ê´€ê³„ë¥¼ êµ¬ì„±í•  ë•Œ ê°ì²´ì§€í–¥ ê°œë°œìë“¤ì€ ì£¼ í…Œì´ë¸”ì— ì™¸ë˜ í‚¤ë¥¼ ì„ í˜¸í•œë‹¤. JPAë„ ì£¼ í…Œì´ë¸”ì— ì™¸ë˜ í‚¤ê°€ ìˆìœ¼ë©´ ì¢€ ë” í¸ë¦¬í•˜ê²Œ ë§¤í•‘í•  ìˆ˜ ìˆë‹¤<br>
ìš°ì„  ë‹¨ë°©í–¥ ê´€ê³„ë¥¼ ì‚´í´ë³´ê³  ì–‘ë°©í–¥ì„ ë³´ë„ë¡ í•˜ì.<br>
<b>ë‹¨ë°©í–¥</b>
<img src="img/entity_constraint_one_to_one01.PNG" width="800px" height="350px">
<pre><code>@Entity
public class Member    {<br>
    @Id @GeneratedValue
    @Column(name = "MEMBER_ID")
    private Long id;<br>
    private String username;<br>
    @OneToOne
    @JoinColumn(name = "LOCKER_ID")
    private Locker locker;
    ...
}<br>
@Entity
public class Locker    {<br>
    @Id @GeneratedValue
    @Column(name = "LOCKER_ID")
    private Long id;<br>
    private String name;
    ...
}</code></pre>
ì¼ëŒ€ì¼ ê´€ê³„ì´ë¯€ë¡œ ê°ì²´ ë§¤í•‘ì— <code>@OneToOne</code>ì„ ì‚¬ìš©í–ˆê³  ë°ì´í„°ë² ì´ìŠ¤ì—ëŠ” LOCKER_ID ì™¸ë˜ í‚¤ì— ìœ ë‹ˆí¬ ì œì•½ì¡°ê±´(UNI)ì„ ì¶”ê°€í–ˆë‹¤.<br>
ë‹¤ìŒìœ¼ë¡œ ë°˜ëŒ€ë°©í–¥ì„ ì¶”ê°€í•´ì„œ ì¼ëŒ€ì¼ ì–‘ë°©í–¥ ê´€ê³„ë¡œ ë§Œë“¤ì–´ë³´ì.
<img src="img/entity_constraint_one_to_one02.PNG" width="800px" height="350px">
<pre><code>@Entity
public class Member    {<br>
    @Id @GeneratedValue
    @Column(name = "MEMBER_ID")
    private Long id;<br>
    private String username;<br>
    @OneToOne
    @JoinColumn(name = "LOCKER_ID")
    private Locker locker;
    ...
}<br>
@Entity
public class Locker    {<br>
    @Id @GeneratedValue
    @Column(name = "LOCKER_ID")
    private Long id;<br>
    private String name;<br>
    @OneToOne(mappedBy = "locker")
    private Member member;
    ...
}</code></pre>
ì–‘ë°©í–¥ì´ë¯€ë¡œ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì„ ì •í•´ì•¼í•œë‹¤. MEMBER í…Œì´ë¸”ì´ ì™¸ë˜í‚¤ë¥¼ ê°€ì§€ê³  ìˆìœ¼ë¯€ë¡œ Member.lockerê°€ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì´ë‹¤. ë”°ë¼ì„œ ë°˜ëŒ€ë§¤í•‘ì¸ ì‚¬ë¬¼í•¨ì˜ Locker.memberì€ mappedByë¡œ lockerí•„ë“œë¥¼ ë°”ë¼ë³´ê²Œ í•´ì¤€ë‹¤.<br>
<h4>ëŒ€ìƒ í…Œì´ë¸”ì— ì™¸ë˜ í‚¤</h4>
ì´ë²ˆì—ëŠ” ëŒ€ìƒ í…Œì´ë¸”ì— ì™¸ë˜ í‚¤ê°€ ìˆëŠ” ì¼ëŒ€ì¼ ê´€ê³„ë¥¼ ì•Œì•„ë³´ì<br>
ìš°ì„  ì¼ëŒ€ì¼ ê´€ê³„ ì¤‘ ëŒ€ìƒ í…Œì´ë¸”ì— ì™¸ë˜ í‚¤ê°€ ìˆëŠ” ë‹¨ë°©í–¥ ê³ ë‚˜ê³„ëŠ” JPAì—ì„œ ì§€ì›í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì–‘ë°©í–¥ ê´€ê³„ë¥¼ ì•Œì•„ë³´ì.
<img src="img/entity_constraint_one_to_one03.PNG" width="800px" height="350px">
<pre><code>@Entity
public class Member    {<br>
    @Id @GeneratedValue
    @Column(name = "MEMBER_ID")
    private Long id;<br>
    private String username;<br>
    @OneToOne
    @JoinColumn(name = "member")
    private Locker locker;
    ...
}<br>
@Entity
public class Locker    {<br>
    @Id @GeneratedValue
    @Column(name = "LOCKER_ID")
    private Long id;<br>
    private String name;<br>
    @OneToOne(mappedBy = "MEMBER_ID")
    private Member member;
    ...
}</code></pre>
ì¼ëŒ€ì¼ ë§¤í•‘ì—ì„œ ëŒ€ìƒ í…Œì´ë¸”ì— ì™¸ë˜ í‚¤ë¥¼ ë‘ê³  ì‹¶ìœ¼ë©´ ì´ë ‡ê²Œ ì–‘ë°©í–¥ìœ¼ë¡œ ë§¤í•‘í•˜ë©´ ëœë‹¤. ì£¼ ì—”í‹°í‹°ì¸ Member ëŒ€ì‹ ì— ëŒ€ìƒ ì—”í‹°í‹°ì¸ Lockerë¥¼ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ìœ¼ë¡œ ë§Œë“¤ì–´ì„œ LOCKER í…Œì´ë¸”ì˜ ì™¸ë˜ í‚¤ë¡œ ê´€ë¦¬í•˜ë„ë¡ í–ˆë‹¤.
<hr>
<h3>ë‹¤ëŒ€ë‹¤ [N:N]</h3>
<hr>
ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ëŠ” ì •ê·œí™”ëœ í…Œì´ë¸” 2ê°œë¡œ ë‹¤ëŒ€ë‹¤ ê´€ê³„ë¥¼ í‘œí˜„í•  ìˆ˜ ì—†ë‹¤. ê·¸ë˜ì„œ ë³´í†µ ë‹¤ëŒ€ë‹¤ ê´€ê³„ë¥¼ ì¼ëŒ€ë‹¤, ë‹¤ëŒ€ì¼ ê´€ê³„ë¡œ í’€ì–´ë‚´ëŠ” ì—°ê²° í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ëŠ”ë°<br>
Memberì™€ Product ì—”í‹°í‹°ê°€ ìˆë‹¤ê³  ì¹˜ë©´ ë‘ í…Œì´ë¸”ì„ ë°”ë¡œ ë‹¤ëŒ€ë‹¤ ê´€ê³„ë¡œ í‘œí˜„í•  ìˆ˜ëŠ” ì—†ë‹¤.<br>
ê·¸ë˜ì„œ ì¤‘ê°„ì— Memberì™€ Productí…Œì´ë¸”ì„ ì—°ê²°í•´ì£¼ëŠ” í…Œì´ë¸”ì„ ë§Œë“¤ì–´ì¤€ë‹¤(Member_Product).<br>
ì´ í…Œì´ë¸”ë¡œ ì¼ëŒ€ë‹¤, ë‹¤ëŒ€ì¼ ê´€ê³„ë¥¼ í’€ì–´ë‚´ì–´ì„œ ë‹¤ëŒ€ë‹¤ ê´€ê³„ë¥¼ ë§¤í•‘ í•  ìˆ˜ ìˆê²Œ ëœë‹¤.<br>
JPAì˜ <code>@ManyToMany</code> ì–´ë…¸í…Œì´ì…˜ì„ í†µí•´ì„œ ë‹¤ëŒ€ë‹¤ ë§¤í•‘ì„ ì‹œì‘í•´ë³´ì.
<h4>ë‹¤ëŒ€ë‹¤: ë‹¨ë°©í–¥</h4>
ë‹¤ëŒ€ë‹¤ ë‹¨ë°©í–¥ì¸ íšŒì›ê³¼ ìƒí’ˆ ì—”í‹°í‹°ë¥¼ ë³´ì.
<pre><code>//íšŒì›
@Entity
public class Member    {<br>
    @Id @Column(name = "MEMBER")
    private String id;<br>
    private String username;<br>
    @ManyToMany
    @JoinTable(name = "MEMBER_PRODUCT",
        joinColumns = @JoinColumn(name = "MEMBER_ID"),
        inverseJoinColumns = @JoinColumn(name = "PRODUCT_ID"))<br>
    private List&#60;Product&#62 products = new ArrayList&#60;Product&#62();
    ...
}<br>
//ë‹¨ë°©í–¥ ìƒí’ˆ
@Entity
public class Product   {<br>
    @Id @Column(name = "PRODUCT_ID")
    private String id;<br>
    private String name;
    ...
}</code></pre>
íšŒì› ì—”í‹°í‹°ì™€ ìƒí’ˆ ì—”í‹°í‹°ë¥¼ <code>@ManyToMany</code>ë¡œ ë§¤í•‘í–ˆë‹¤. ì—¬ê¸°ì„œ ì¤‘ìš”í•œê±´ <code>@ManyToMany</code>ì™€ <code>@JoinTable</code>ì„ ì‚¬ìš©í•´ì„œ ì—°ê²° í…Œì´ë¸”ì„ ë°”ë¡œ ë§¤í•‘í•œ ê²ƒì´ë‹¤.<br>
íšŒì›ê³¼ ìƒí’ˆì„ ì—°ê²°í•˜ëŠ” íšŒì›_ìƒí’ˆ(Member_Product) ì—”í‹°í‹° ì—†ì´ ë§¤í•‘ì„ ì™„ë£Œí•  ìˆ˜ ìˆë‹¤.<br>
ì—°ê²° í…Œì´ë¸”ì„ ë§¤í•‘í•˜ëŠ” <code>@JoinTAble</code>ì˜ ì†ì„±ì„ ì •ë¦¬í•´ë³´ì.
<ul>
    <li><code>@JoinTable.name</code>: ì—°ê²° í…Œì´ë¸”ì„ ì§€ì •í•œë‹¤. í˜„ì¬ ì˜ˆì œì—ì„œëŠ” MEMBER_PRODUCT í…Œì´ë¸”ì„ ì„ íƒí–ˆë‹¤.</li>
    <li><code>@JoinTable.joinColumns</code>: í˜„ì¬ ë°©í–¥ì¸ íšŒì›ê³¼ ë§¤í•‘í•  ì¡°ì¸ ì»¬ëŸ¼ ì •ë³´ë¥¼ ì§€ì •í•œë‹¤. MEMBER_IDë¡œ ì§€ì •í–ˆë‹¤.</li>
    <li><code>@JoinTable.inverseJoinColumns</code>: ë°˜ëŒ€ ë°©í–¥ì¸ ìƒí’ˆê³¼ ë§¤í•‘í•  ì¡°ì¸ ì»¬ëŸ¼ ì •ë³´ë¥¼ ì§€ì •í•œë‹¤. PRODUCT_IDë¡œ ì§€ì •í–ˆë‹¤.</li>
</ul><br>
MEMBER_PRODUCT í…Œì´ë¸”ì€ ë‹¤ëŒ€ë‹¤ ê´€ê³„ë¥¼ ì¼ëŒ€ë‹¤, ë‹¤ëŒ€ì¼ ê´€ê³„ë¡œ í•„ìš”í•œ ì—°ê²° í…Œì´ë¸”ì¼ ë¿ì´ë‹¤. <code>@ManyToMany</code>ë¡œ ë§¤í•‘í•´ë‘ë©´ ì´ í…Œì´ë¸”ì„ ì‹ ê²½ì“°ì§€ì•Šì•„ë„ ëœë‹¤. ì´ì œ ì €ì¥í•˜ëŠ” ì˜ˆì œë¥¼ ì‚´í´ë³´ì<br>
<pre><code>public void save()   {<br>
    Product productA = new Product();
    productA.setId("productA");
    productA.setName("ìƒí’ˆA");
    em.persist(productA);<br>
    Member member1 = new Member();
    member1.setId("member1");
    member1.setUsername("íšŒì›1");
    member1.getProducts().add(productA);    //ì—°ê´€ê´€ê³„ ìƒì„±
    em.persist(member1);
}</code></pre>
íšŒì›1ê³¼ ìƒí’ˆAì˜ ì—°ê´€ê´€ê³„ë¥¼ ì„¤ì •í–ˆìœ¼ë¯€ë¡œ íšŒì›1ì„ ì €ì¥í•  ë•Œ ì—°ê²°í…Œì´ë¸”ì—ë„ ê°’ì´ ì €ì¥ëœë‹¤. ê·¸ëŸ¬ë¯€ë¡œ ì•„ë˜ì˜ SQLì´ ì‹¤í–‰ëœë‹¤.
<pre><code>INSERT INTO PRODUCT ...
INSERT INTO MEMBER ...
INSERT INTO MEMBER_PRODUCT ...</code></pre>
ì´ì œ ì €ì¥í•œ Productë¥¼ ì¡°íšŒí•´ë³´ì.
<pre><code>public void find()   {
    Member member = em.find(Member.class, "member1");
    List&#60;Product&#62 products = member.getProducts();   //ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰
    for (Product product : products)    {
        System.out.println("product.name = " = product.getName());
    }
}</code></pre>
<code>member.getProduct</code> ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ê³  ìƒí’ˆ ì´ë¦„ì„ ì¶œë ¥í•˜ë©´ ë‹¤ìŒ SQLì´ ì‹¤í–‰ëœë‹¤.
<pre><code>SELECT * FROM MEMBER_PRODUCT MP
INNER JOIN PRODUCT P ON MP.PRODUCT_ID=P.PRODUCT_ID
WHERE MP.PRODUCT=?</code></pre>
ì‹¤í–‰ëœ SQLì„ ë³´ë©´ ì—°ê²° í…Œì´ë¸”ì¸ MEMBER_PRODucTì™€ ìƒí’ˆ í…Œì´ë¸”ì„ ì¡°ì¸í•´ì„œ ì—°ê´€ëœ ìƒí’ˆì„ ì¡°íšŒí•œë‹¤.<br>
<code>@ManyToMany</code> ë•ë¶„ì— ë‹¤ëŒ€ë‹¤ ê´€ê³„ë¥¼ ì–´í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” ë‹¨ìˆœí•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
<h4>ë‹¤ëŒ€ë‹¤: ì–‘ë°©í–¥</h4>
ë‹¤ëŒ€ë‹¤ ë§¤í•‘ì´ë¯€ë¡œ ì—­ë°©í–¥ë„ <code>@ManyToMany</code>ë¥¼ ì„¤ì •í•´ì¤€ë‹¤. ê·¸ë¦¬ê³  ì–‘ìª½ ì¤‘ ì›í•˜ëŠ” ê³³ì— <code>mappedBy</code>ë¡œ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì„ ì§€ì •í•œë‹¤.(ë¬¼ë¡  <code>mappedBy</code>ê°€ ì—†ëŠ” ê³³ì´ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì´ë‹¤.)<br>
<pre><code>@Entity
public class Product   {<br>
    @Id
    private String id;<br>
    @ManyToMany (mappedBy = "products") //ì—­ë°©í–¥ ì¶”ê°€
    private List&#60;Member&#62 members;
    ...
}</code></pre>
ë‹¤ëŒ€ë‹¤ì˜ ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ëŠ” ë‹¤ìŒì²˜ëŸ¼ ì„¤ì •í•˜ë©´ ëœë‹¤.
<pre><code>member.getProducts().add(product);
product.getMembers().add(member);</code></pre>
í¸ì˜ ë©”ì†Œë“œë¡œ ë¦¬íŒ©í† ë§í•˜ë©´
<pre><code>public void addProduct(Product product)  {
    ...
    products.add(product);
    product.getMembers().add(this);
}</code></pre>
ì—°ê´€ê´€ê³„ í¸ì˜ ë©”ì†Œë“œë¥¼ ì¶”ê°€í–ˆìœ¼ë¯€ë¡œ ë‹¤ìŒì²˜ëŸ¼ ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ë¥¼ ì„¤ì •í•˜ë©´ ëœë‹¤.<br>
<code>member.addProduct(product);</code><br>
ì–‘ë°©í–¥ìœ¼ë¡œ ì—°ê´€ê´€ê³„ê°€ ì„¤ì •ë˜ì—ˆìœ¼ë¯€ë¡œ <code>product.getMembers()</code>ë¥¼ ì‚¬ìš©í•´ì„œ ì—­ë°©í–¥ìœ¼ë¡œ ê°ì²´ ê·¸ë˜í”„ë¥¼ íƒìƒ‰í•  ìˆ˜ ìˆë‹¤.
<br>
ì–‘ë°©í–¥ ì—°ê´€ê´€ê²Œë¥¼ ë§Œë“¤ì—ˆìœ¼ë¯€ë¡œ <code>product.getmembers()</code>ë¥¼ ì‚¬ìš©í•´ì„œ ì—­ë°©í–¥ìœ¼ë¡œ ê°ì²´ ê·¸ë˜í”„ë¥¼ íƒìƒ‰í•  ìˆ˜ ìˆë‹¤.
<pre><code>public void findInverse()   {<br>
    Product product = em.find(Product.class, "productA");
    List&#60;Member&#62 members = product.getmembers();
    for (Member member : members)   {
        System.out.println("member = " + member.getUsername());
    )
}</code></pre>
ìœ„ ì½”ë“œì²˜ëŸ¼ ì—­ë°©í–¥ íƒìƒ‰ì„ í•  ìˆ˜ ìˆë‹¤.
<h4>ë‹¤ëŒ€ë‹¤: ë§¤í•‘ì˜ í•œê³„ì™€ ê·¹ë³µ, ì—°ê²° ì—”í‹°í‹° ì‚¬ìš©</h4>
<code>@ManyToMany</code>ë¥¼ ì‚¬ìš©í•˜ë©´ ì—°ê²° í…Œì´ë¸”ì„ ìë™ìœ¼ë¡œ ì²˜ë¦¬í•´ì£¼ë¯€ë¡œ ë„ë©”ì¸ ëª¨ë¸ì´ ë‹¨ìˆœí•´ì§€ê³  ì—¬ëŸ¬ ê°€ì§€ë¡œ í¸ë¦¬í•˜ë‹¤. í•˜ì§€ë§Œ ì§€ê¸ˆ ìƒíƒœì—ì„œëŠ” ì–¸ì œ ì£¼ë¬¸ì„ í–ˆëŠ”ì§€, ì£¼ë¬¸ ìˆ˜ëŸ‰ì€ ì–¼ë§ˆì¸ì§€ ì•Œ ìˆ˜ ì—†ë‹¤.<br>
Memberì™€ Product ì‚¬ì´ì˜ í…Œì´ë¸” MemberProductì— ì£¼ë¬¸ìˆ˜ëŸ‰ê³¼ ì£¼ë¬¸ ë‚ ì§œ ì»¬ëŸ¼ì„ ì¶”ê°€í•´ ë³´ì.
[ê·¸ë¦¼ ì—…ë°ì´íŠ¸ ì˜ˆì •-p226]
ìœ„ì™€ ê°™ì´ ì—”í‹°í‹°ë¥¼ ì„¤ì •í•  ê²ƒì´ë‹¤ ì•„ë˜ ì½”ë“œë¥¼ ë³´ì.
<pre><code>//íšŒì› ì½”ë“œ
@Entity
public class Member{<br>
    @Id
    @Column (name = "MEMBER_ID")
    private Long id;<br>
    @OneToMany(mappedBy = "member")
    private List&#60;MemberProducts&#62 memberproducts;<br>
    ...
}<br>
//ìƒí’ˆ ì½”ë“œ
@Entity
public class Product  {<br>
    @Id
    @Column (name = "PRODUCT_ID")
    private String id;<br>
    private String name;<br>
    ...
}<br>
//íšŒì› ìƒí’ˆ ì—”í‹°í‹° ì½”ë“œ
@Entity
@IdClass(MemberProductId.class)
public class MemberProduct  {<br>
    @Id
    @ManyToOne
    @JoinColumn(name = "MEMBER_ID")
    private Member member;  //MemberProductId.member ì™€ ì—°ê²°<br>
    @Id
    @ManyToOne
    @JoinColumn(name = "PRODUCT_ID")
    private Product product;    //MemberProductId.productì™€ ì—°ê²°<br>
    private int orderAmount;<br>
    ...
}
//íšŒì›ìƒí’ˆ ì‹ë³„ì í´ë˜ìŠ¤
public class MemberProductId implements Serializable   {<br>
    private String member;  //MemberProduct.memberì™€ ì—°ê²°
    private String product; //MemberProduct.productì™€ ì—°ê²°<br>
    //hashCode and equals<br>
    @Override
    public boolean equals(Object o) {...}<br>
    @Override
    public int hashCode()   {...}
}</code></pre>
ìœ„ì™€ ê°™ì´ MemberProduct í´ë˜ìŠ¤ì—ì„œ ë³µí•©í‚¤ë¡œ ë§¤í•‘í•˜ê¸° ìœ„í•´ ìš°ì„  ê¸°ë³¸ í‚¤ë¥¼ ë§¤í•‘í•˜ëŠ” <code>@Id</code>ì™€ <code>@JoinColumn</code>ì„ ë™ì‹œì— ì‚¬ìš©í•´ì„œ ê¸°ë³¸ í‚¤ + ì™¸ë˜ í‚¤ë¥¼ í•œë²ˆì— ë§¤í•‘í–ˆë‹¤.<br>
<code>@IdClass</code> ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•´ì„œ ë³µí•© ê¸°ë³¸ í‚¤ë¥¼ ë§¤í•‘í•˜ê³   ì‹ë³„ì í´ë˜ã…”ìŠ¤ë¥¼ ì •ì˜í–ˆë‹¤. JPAì—ì„œ ë³µí•© ê¸°ë³¸ í‚¤ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ì‹ë³„ì í´ë˜ìŠ¤ë¥¼ ìœ„ì™€ê°™ì´ ë§Œë“¤ì–´ì•¼í•˜ëŠ”ë° ì•„ë˜ ì¡°ê±´ë“¤ì´ ìˆë‹¤.
<ul>
    <li>ë³µí•© í‚¤ëŠ” ë³„ë„ì˜ ì‹ë³„ì í´ë˜ìŠ¤ë¡œ ë§Œë“¤ì–´ì•¼ í•œë‹¤.</li>
    <li><code>Serializable</code>ì„ êµ¬í˜„í•´ì•¼ í•œë‹¤.</li>
    <li><code>equals</code>ì™€ <code>hashCode</code> ë©”ì†Œë“œë¥¼ êµ¬í˜„í•´ì•¼ í•œë‹¤.</li>
    <li>ê¸°ë³¸ ìƒì„±ìê°€ ìˆì–´ì•¼ í•œë‹¤</li>
    <li>ì‹ë³„ì í´ë˜ìŠ¤ëŠ” <code>public</code>ì´ì–´ì•¼ í•œë‹¤.</li>
    <li><code>@IdClass</code>ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²• ì™¸ì— <code>@EmbeddedId</code>ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ë„ ìˆë‹¤.</li>
    
</ul>
MemberProductëŠ” íšŒì›ê³¼ ìƒí’ˆì˜ ê¸°ë³¸ í‚¤ë¥¼ ë°›ì•„ì„œ ìì‹ ì˜ ê¸°ë³¸í‚¤ë¡œ ì‚¬ìš©í•˜ëŠ”ë° ì´ë ‡ê²Œ ë¶€ëª¨ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ë¥¼ ë°›ì•„ì„œ ìì‹ ì˜ ê¸°ë³¸ í‚¤ + ì™¸ë˜ í‚¤ë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œëŠ” ì‹ë³„ ê´€ê³„ë¼ í•œë‹¤.<br>
ì´ë ‡ê²Œ êµ¬í˜„í•œ ê´€ê³„ë¥¼ ì–´ë–»ê²Œ ì €ì¥í•˜ëŠ”ì§€ ì‚´í´ë³´ì
<pre><code>public void save()  {<br>
    //íšŒì› ì €ì¥
    Member member1 = new Member();
    member1.setId("member1");
    member1.setUsername("íšŒì›1");
    em.persist(member1);<br>
    //ìƒí’ˆ ì €ì¥
    Product productA = new Product();
    productA.setId("productA");
    productA.setName("ìƒí’ˆ1");
    em.persist(productA);<br>
    //íšŒì›ìƒí’ˆ ì €ì¥
    MemberProduct memberProduct = new MemberProduct();
    memberProduct.setMember(member1);   //ì£¼ë¬¸ íšŒì› - ì—°ê´€ê´€ê³„ ì„¤ì •
    memberProduct.setProduct(product1); //ì£¼ë¬¸ ìƒí’ˆ - ì—°ê´€ê´€ê³„ ì„¤ì •
    memberProduct.setOrderAmount(2);    //ì£¼ë¬¸ ìˆ˜ëŸ‰<br>
    em.persist(memberProduct);
}</code></pre>
ìœ„ì²˜ëŸ¼ íšŒì› ìƒí’ˆì—”í‹°í‹°ë¥¼ ë§Œë“¤ë©´ì„œ ì—°ê´€ëœ íšŒì›, ìƒí’ˆ ì—”í‹°í‹°ë¥¼ ì„¤ì •í•˜ë©´ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•  ë•Œ ê°ê°ì˜ ì‹ë³„ìë¥¼ ê°€ì ¸ì™€ì„œ ìì‹ ì˜ ê¸°ë³¸ í‚¤ ê°’ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤.<br>
ë‹¤ìŒìœ¼ë¡œëŠ” ì¡°íšŒí•˜ëŠ” ì½”ë“œë¥¼ ì‚´í´ë³´ì.
<pre><code>public void find()   { 
    //ê¸°ë³¸ í‚¤ ê°’ ìƒì„±
    MemberProductId.memberProductId = new MemberProductId();
    MemberProductId.setMember("member1");
    MemberProductId.setProduct("productA");<br>
    MemberProduct memberProduct = em.find(MemberProduct.class, memberProductId);<br>
    Member member = memberProduct.getMember();
    Product product = memberProduct.getProduct();<br>
    System.out.println("member = " + member.getUsername());
    System.out.println("product = " + product.getName());
    System.out.println("orderAmount = " + 
        memberProduct.getOrderAmount());<br>
}</code></pre>
ë³µí•©í‚¤ë¥¼ ì‚¬ìš©í•˜ë©´ ì´ì œ í•­ìƒ ì‹ë³„ì í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ì•¼ í•œë‹¤. ì‹ë³„ì í´ë˜ìŠ¤ë¥¼ <code>em.find()</code>ë¡œ ì‹ë³„ìë¥¼ ì¡°íšŒí•´ì„œ ì—°ê´€ ì—”í‹°í‹°ë¥¼ ìƒì„±í•œë‹¤.<br>
ë³µí•©í‚¤ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ORM ë§¤í•‘ì—ì„œ ì²˜ë¦¬í•´ì•¼ í•  ì¼ì´ ë§ì•„ì§€ë¯€ë¡œ ë³µí•© í‚¤ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  ë‹¤ëŒ€ë‹¤ ê´€ê³„ë¥¼ êµ¬ì„±í•˜ëŠ” ë°©ë²•ë„ ì•Œì•„ë³´ì.<br>
<h4>ë‹¤ëŒ€ë‹¤: ìƒˆë¡œìš´ ê¸°ë³¸í‚¤ ì‚¬ìš©</h4>
ì¶”ì²œí•˜ëŠ” ê¸°ë³¸ í‚¤ ìƒì„± ì „ëµì€ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ìë™ìœ¼ë¡œ ìƒì„±í•´ì£¼ëŠ” ëŒ€ë¦¬ í‚¤ë¥¼ Long ê°’ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ë‹¤.<br>
ì´ë ‡ê²Œ í•˜ë©´ ê±°ì˜ ì˜êµ¬íˆ ì“¸ ìˆ˜ ìˆìœ¼ë©° ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì— ì˜ì¡´í•˜ì§€ ì•ŠëŠ”ë‹¤. ë˜í•œ ORM ë§¤í•‘ ì‹œ ë³µí•© í‚¤ë¥¼ ë§Œë“¤ì§€ ì•Šì•„ë„ ëœë‹¤.<br>
[ê·¸ë¦¼ - ì—…ë°ì´íŠ¸ ì˜ˆì •(p231)]<br>
ìœ„ì˜ ê·¸ë¦¼ì„ ë³´ë©´ ORDER_IDë¼ëŠ” ìƒˆë¡œìš´ ê¸°ë³¸ í‚¤ë¥¼ í•˜ë‚˜ ë§Œë“¤ê³  ì´ì „ì— ë³µí•© í‚¤ë¡œ ì‚¬ìš©í–ˆë˜ MEMBER_ID, PRODUCT_ID ì»¬ëŸ¼ì€ ì™¸ë˜ í‚¤ë¡œë§Œ ì‚¬ìš©í•œë‹¤.<br>
êµ¬í˜„ ì½”ë“œë¥¼ ë³´ì.
<pre><code>@Entity
public class Order {<br>
    @Id @GeneratedValue
    @Column(name = "ORDER_ID")
    private Long id;<br>
    @ManyToOne
    @JoinColumn(name = "MEMBER_ID")
    private Member member;<br>
    @ManyToOne
    @JoinColumn(name = "PRODUCT_ID")
    private Product product;<br>
    private int orderAmount;
    ...
}</code></pre>
ëŒ€ë¦¬í‚¤ë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ì‹ë³„ìí´ë˜ìŠ¤ë¥¼ ì •ì˜í•  í•„ìš”ê°€ ì—†ì–´ì¡Œê³  ì´í•´ë„ í•˜ê¸°ê°€ ì‰¬ì›Œì¡Œë‹¤. ì €ì¥í•˜ê³  ì¡°íšŒí•˜ëŠ” ì½”ë“œë¥¼ í™•ì¸í•´ë³´ì.
<pre><code>//ì €ì¥
public void save()  {<br>
   //íšŒì› ì €ì¥
   Member member1 = new Member();
   member1.setId("member1");
   member1.setUsername("íšŒì›1");
   em.persist(member1);<br>
   //ìƒí’ˆ ì €ì¥
   Product productA = new Product();
   productA.setId("productA");
   productA.setName("ìƒí’ˆ1");
   em.persist(productA);<br>
   //íšŒì›ìƒí’ˆ ì €ì¥
   Order order = new Order();
   order.setMember(member1);   //ì£¼ë¬¸ íšŒì› - ì—°ê´€ê´€ê³„ ì„¤ì •
   order.setProduct(product1); //ì£¼ë¬¸ ìƒí’ˆ - ì—°ê´€ê´€ê³„ ì„¤ì •
   order.setOrderAmount(2);    //ì£¼ë¬¸ ìˆ˜ëŸ‰<br>
   em.persist(order);
}<br>
//ì¡°íšŒ 
public void find()   { 
    //ê¸°ë³¸ í‚¤ ê°’ ìƒì„±
    Long orderId = 1L;
    Order order = em.find(Order.class, orderId);<br>
    Member member = order.getMember();
    Product product = order.getProduct();<br>
    System.out.println("member = " + member.getUsername());
    System.out.println("product = " + product.getName());
    System.out.println("orderAmount = " + 
        order.getOrderAmount());<br>
}</code></pre>
ì½”ë“œê°€ ì‹ë³„ì í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•  ë•Œë³´ë‹¤ í›¨ì”¬ ë‹¨ìˆœí•´ì§„ê±¸ ì•Œ ìˆ˜ ìˆë‹¤.<br>
<h4>ë‹¤ëŒ€ë‹¤ ì—°ê´€ê´€ê³„ ì •ë¦¬</h4>
ë‹¤ëŒ€ë‹¤ ê´€ê³„ë¥¼ ì¼ëŒ€ë‹¤ ë‹¤ëŒ€ì¼ ê´€ê³„ë¡œ í’€ì–´ë‚´ê¸°ìœ„í•´ ì—°ê²° í…Œì´ë¸”ì„ ë§Œë“¤ ë•Œ ì‹ë³„ìë¥¼ ì–´ë–»ê²Œ êµ¬ì„±í• ì§€ ì„ íƒí•´ì•¼ í•œë‹¤.<br>
<ul>
    <li>ì‹ë³„ ê´€ê³„: ë°›ì•„ì˜¨ ì‹ë³„ìë¥¼ ê¸°ë³¸ í‚¤ + ì™¸ë˜ í‚¤ë¡œ ì‚¬ìš©í•œë‹¤.</li>
    <li>ë¹„ì‹ë³„ ê´€ê³„: ë°›ì•„ì˜¨ ì‹ë³„ìëŠ” ì™¸ë˜ í‚¤ë¡œë§Œ ì‚¬ìš©í•˜ê³  ìƒˆë¡œìš´ ì‹ë³„ìë¥¼ ì¶”ê°€í•œë‹¤.</li>
</ul>
ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„ì—ì„œëŠ” 1ë²ˆì²˜ëŸ¼ ë¶€ëª¨ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ë¥¼ ë°›ì•„ì„œ ìì‹ í…Œì´ë¸”ì˜ ê¸°ë³¸ í‚¤ + ì™¸ë˜ í‚¤ë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì‹ë³„ ê´€ê³„ë¼ í•˜ê³ , 2ë²ˆì²˜ëŸ¼ ë‹¨ìˆœíˆ ì™¸ë˜ í‚¤ë¡œë§Œ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ë¹„ì‹ë³„ ê´€ê³„ë¼ í•œë‹¤.<br>
ê°ì²´ ì…ì¥ì—ì„œ ë³´ë©´ 2ë²ˆì²˜ëŸ¼ ë¹„ì‹ë³„ ê´€ê³„ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ í¸ë¦¬í•˜ê²Œ ORM ë§¤í•‘ì„ í•  ìˆ˜ ìˆë‹¤. ì´ìœ ëŠ” 7-3ì ˆì—ì„œ ì•Œì•„ë³´ì.